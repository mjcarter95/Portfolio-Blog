---
export interface Props {
  title: string;
  subtitle?: string;
  backgroundImage: string;
  date?: Date;
  readTime?: number;
  tags?: string[];
  series?: string;
  series_order?: number;
}

import { slugifyTag } from "@/utils/tags";
const { title, subtitle, backgroundImage, date, readTime, tags, series, series_order } = Astro.props;
---

<section
  class="w-full bg-cover bg-center bg-no-repeat text-white"
  style={`background-image: url('${backgroundImage}');`}
>
  <div class="bg-black/50">
    <div class="max-w-6xl mx-auto px-6 py-20 text-left h-[42vh] min-h-[280px] max-h-[500px] flex flex-col justify-end">
      <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-6">
        <!-- Left side: title, subtitle, stats, buttons -->
        <div>
          <h1 class="text-4xl font-bold mt-4">{title}</h1>
          {subtitle && <p class="mt-2 text-white/90 text-base">{subtitle}</p>}

          {(date || readTime || (tags && tags.length > 0) || series) && (
            <div class="mt-6 flex flex-wrap items-center gap-3 text-sm text-white/90">
              {date && (
                <time datetime={date.toISOString()}>
                  {date.toLocaleDateString("en-GB", {
                    year: "numeric",
                    month: "long",
                    day: "2-digit",
                  })}
                </time>
              )}
              {readTime && <span>· {readTime} min read</span>}
              {series && (
                <>
                  <span aria-hidden="true">·</span>
                  <a
                    href={`/series/${slugifyTag(series)}/`}
                    class="underline hover:text-white transition"
                  >
                    Part {series_order}: {series}
                  </a>
                </>
              )}
              {tags?.length > 0 && (
                <>
                  <span aria-hidden="true">·</span>
                  <ul class="flex gap-2 flex-wrap">
                    {tags.slice(0, 3).map((tag) => (
                      <li>
                        <a
                          href={`/tags/${slugifyTag(tag)}/`}
                          class="px-2 py-0.5 rounded bg-white/20 text-white hover:bg-white/30 transition"
                        >
                          {tag}
                        </a>
                      </li>
                    ))}
                  </ul>
                </>
              )}
            </div>
          )}

          <!-- ✅ BUTTONS (ACTIONS SLOT) — no bg-white anywhere around this -->
          <div class="mt-6">
            <slot name="actions" />
          </div>
        </div>

        <!-- Right-side slot (e.g., search bar) -->
        <div>
          <slot name="rightContent" />
        </div>
      </div>
    </div>
  </div>
</section>
